
<script type="text/javascript">
	$(document).ready(function () {
		$('#lstUserGroup').select2({
		});
		$('#lstGroupRole').select2({
		});

        var isFormChanged = false;
        var isConfirmed = false;
        $("form :input").change(function() {
            console.log($(this).attr('name') + " has changed");
            isFormChanged = true;
            $("#isFormChanged").val(true);
        });
        
        $("#lstUserGroup").change(function() {
        	console.log("UserGroup has changed");
        	$("#isUserGroupChanged").val(true);
        })
        
         $("#lstGroupRole").change(function() {
        	console.log("GroupRole has changed");
        	$("#isGroupRoleChanged").val(true);
        })
        
        //console.log($('#status').prop("checked"));
        if($('#status').prop("checked")) {
                $('#statusLabel').text("Kích hoạt");
            } else {
            	$('#statusLabel').text("Khóa");
            }
        
        $('#status').change(function() {
            if(this.checked) {
                $('#statusLabel').text("Kích hoạt");
            } else {
            	$('#statusLabel').text("Khóa");
            }
            
        });
	});
</script>

<section class="content">

            <div class="col-xs-12">
			<div class="box box-info">
				<!-- form start -->
				<form class="form-horizontal" th:action="@{/group/save}" method="post">
				
					<input type="hidden" id="isFormChanged" name="isFormChanged" value="false">
					<input type="hidden" id="isUserGroupChanged" name="isUserGroupChanged" value="false">
					<input type="hidden" id="isGroupRoleChanged" name="isGroupRoleChanged" value="false">
					<input type="hidden" id="id" name="id" th:value="${group.id}">
					
					<div class="box-body">
						<div class="form-group row">
							<label for="name" class="col-sm-3 control-label col-form-label">Tên nhóm</label>
							<div class="col-sm-5">
								<input type="text" class="form-control" id="name" name="name" th:value="${group.name}">
							</div>
						</div>
						<div class="form-group row">
							<label class="col-sm-3 control-label text-right">Trạng thái</label>
							<div class="col-sm-5">
								<div class="custom-control custom-switch switch-primary">
									<input value="1" type="checkbox" name="status" class="custom-control-input" id="status" th:checked="${group.status==1}">
									<label id="statusLabel" class="custom-control-label" for="status"></label>
								</div>
							</div>
						</div>
						<div class="form-group row">
							<label for="roleName" class="col-sm-3 control-label col-form-label">Quyền</label>
							<div class="col-sm-5">
							  <select id="lstGroupRole" class="form-control select2" style="width: 100%;" data-placeholder="Chọn quyền" name="roleIds" multiple>
		                          <option th:each="r : ${allRoles}" th:value="${r.id}" th:selected="${roles!=null && roles.contains(r.name)}">[[${r.name}]]</option>
							  </select>
							</div>
						</div>
						<div class="form-group row">
							<label for="groupName" class="col-sm-3 control-label col-form-label">Người dùng trong nhóm</label>
							<div class="col-sm-5">
							  <select id="lstUserGroup" class="form-control select2" style="width: 100%;" data-placeholder="Select users" name="userIds" multiple>
		                          <option th:each="user : ${allUsers}" th:value="${user.id}" th:selected="${usernames!=null && usernames.contains(user.username)}">[[${user.username}]]</option>
		                      </select>
							</div>
						</div>

					</div>
					<!-- /.box-body -->
					<div class="row">
						<div class="col-sm-3"></div>
						<div class="col-sm-5 text-right">
							<a th:href="@{/group/}" class="btn btn-gradient-warning pull-left">[[#{cancel}]]</a>
							<a th:if="${action!='create'}" class="btn btn-danger" onclick="return confirm('Chắc chắn xóa?')" th:href="@{'/group/delete/' + ${group.id}}">[[#{delete}]]</a>
							<button type="submit" class="btn btn-gradient-primary" th:text="#{${action=='create'? 'save' : 'update'}}">Lưu</button>
						</div>
					</div>
				</form>
			</div>
		</div>
</section>
